<!doctype html>
<html lang="pt-br">
  <head>
    <style>
  html{ visibility: hidden; }
  html.auth-ok{ visibility: visible; }
</style>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Produtos | ForceLab ADM</title>

    <!-- ‚úÖ sempre absoluto -->
    <link rel="stylesheet" href="/admin/admin.css" />
  </head>

  <body>
    <!-- ‚úÖ sempre absoluto -->
    <script type="module" src="/admin/protect.js"></script>

    <div class="admin">
      <div id="sidebar"></div>

      <main class="main">
        <header class="mobilebar">
          <button class="micon" id="openSidebar" type="button" aria-label="Abrir menu">‚ò∞</button>
          <div class="mobilebar-title">
            <strong id="pageTitle">Painel</strong>
            <small class="muted">ForceLab ADM</small>
          </div>
        </header>

        <div class="sidebar-backdrop" id="sidebarBackdrop" aria-hidden="true"></div>

        <header class="top">
          <div>
            <h2>Produtos</h2>
            <div class="muted">Cadastre, edite e destaque produtos do cat√°logo.</div>
          </div>

          <div class="top-actions">
            <div class="search">
              <span style="color:#111;opacity:.7">üîé</span>
              <input id="productsSearch" placeholder="Buscar por nome..." />
            </div>
            <button class="icon" id="btnNew" type="button" title="Novo produto">Ôºã</button>
            <button class="icon" id="btnRefresh" type="button" title="Atualizar">‚ü≤</button>
          </div>
        </header>

        <section class="products-toolbar">
          <div class="pill">
            <strong id="productsCount">0</strong>
            <span>produtos</span>
          </div>

          <div class="filters">
            <select id="filterFeatured">
              <option value="all">Todos</option>
              <option value="featured">Somente destaques</option>
              <option value="not-featured">Sem destaque</option>
            </select>

            <select id="sortProducts">
              <option value="name-asc">A‚ÄìZ</option>
              <option value="name-desc">Z‚ÄìA</option>
              <option value="price-asc">Menor pre√ßo</option>
              <option value="price-desc">Maior pre√ßo</option>
            </select>

            <button class="btn btn-ghost" id="btnClear" type="button">Limpar</button>
          </div>
        </section>

        <section class="table">
          <div class="table-head">
            <h3>Lista de produtos</h3>
            <small class="muted">Clique em ‚ÄúEditar‚Äù para alterar dados</small>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Produto</th>
                  <th>Pre√ßo</th>
                  <th>Destaque</th>
                  <th style="width:220px">A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="productsTbody">
                <tr>
                  <td colspan="4" class="muted">Carregando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </main>
    </div>

    <!-- MODAL -->
    <div class="modal" id="productModal" aria-hidden="true">
      <div class="modal-backdrop" data-close="1"></div>

      <div class="modal-card" role="dialog" aria-modal="true" aria-label="Produto">
        <div class="modal-head">
          <div>
            <h3 id="pTitle">Novo produto</h3>
            <small class="muted" id="pSub">Preencha os campos e salve</small>
          </div>
          <button class="icon" type="button" data-close="1" aria-label="Fechar">‚úï</button>
        </div>

        <div class="modal-body">
          <form id="productForm" class="form-grid">
            <div class="form-col">
              <label class="label" for="pName">Nome</label>
              <input id="pName" class="input" required placeholder="Ex: Whey 900g" />

              <label class="label" for="pPrice">Pre√ßo</label>
              <input id="pPrice" class="input" type="number" step="0.01" required placeholder="Ex: 199.90" />

              <label class="label" for="pOldPrice">Pre√ßo antigo (opcional)</label>
              <input id="pOldPrice" class="input" type="number" step="0.01" placeholder="Ex: 249.90" />

              <label class="label" for="pPixPrice">Pre√ßo Pix (opcional)</label>
              <input id="pPixPrice" class="input" type="number" step="0.01" placeholder="Ex: 189.90" />

              <label class="label" for="pInstallments">Parcelas (opcional)</label>
              <input id="pInstallments" class="input" type="number" min="1" max="12" placeholder="Ex: 3" />

              <label class="label" for="pFeatured">
                <input id="pFeatured" type="checkbox" />
                Marcar como destaque (featured)
              </label>
            </div>

            <div class="form-col">
              <label class="label" for="pImage">Imagem (URL)</label>
              <input id="pImage" class="input" required placeholder="https://..." />

              <label class="label" for="pImageFile">Ou escolher imagem do PC</label>
              <input id="pImageFile" class="input" type="file" accept="image/*" />

              <div class="upload-row">
                <button class="btn btn-ghost" id="btnUploadImg" type="button">Enviar imagem</button>
                <small class="muted" id="pUploadMsg"></small>
              </div>

              <div class="preview">
                <div class="preview-box" id="pPreviewBox">üñºÔ∏è</div>
                <small class="muted">Preview da imagem</small>
              </div>

              <label class="label" for="pCategory">Categoria (opcional)</label>
              <input id="pCategory" class="input" placeholder="Ex: creatina / proteinas / pre-treino" />

              <label class="label" for="pDescription">Descri√ß√£o (opcional)</label>
              <textarea id="pDescription" class="textarea" rows="5" placeholder="Detalhes do produto..."></textarea>

              <div class="form-actions">
                <button class="btn btn-primary" id="btnSave" type="submit">Salvar</button>
                <button class="btn btn-ghost" id="btnDelete" type="button">Excluir</button>
              </div>

              <small class="muted" id="pMsg"></small>
            </div>
          </form>
        </div>
      </div>
    </div>
<script type="module">
  const mount = document.getElementById("sidebar");

  // 1) injeta o sidebar primeiro
  const html = await fetch("/admin/sidebar.html").then(r => r.text());
  mount.innerHTML = html;

  // 2) s√≥ depois carrega os scripts que dependem do sidebar existir
  await import("/admin/ui.js");
  await import("/admin/logout.js");  // se voc√™ tem esse arquivo no /admin/
  await import("/admin/produtos.js");
</script>

  </body>
</html>
